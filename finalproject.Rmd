---
title: "finalproject"
author: "Kiera O'Brien"
date: "4/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
library(ggplot2)
library(dplyr)
library(vctrs)
library(rsconnect)
library(shiny)
library(haven)
library(readxl)

rsconnect::setAccountInfo(name='kieraobrien',
			  token='D36A6A60ACFFD2CA1CB5F3ED10FE5C4C',
			  secret='Hx28vDzuEizm14tABGzGmdr/B7WFerO7MLHYzILd')
```

``` {r data, include = F}

# Note: each of these datasets comes with a guide for interpretation.
# It is on the CCES website. I used it to help select useful questions.
# https://cces.gov.harvard.edu/, under each year. 

# reading in excel file of CCES 2018 data

cces2018 <- read_excel("cces2018.xlsx")

cces2018 <- na.omit(cces2018)
View(cces2018)
```

``` {r plot, echo = F, warning = F}

# creating ggplot for EPA CO2 regulation

figure1 <- ggplot(cces2018, 
                  aes(x = cces2018$CO2)) + 
  geom_bar(mapping = NULL, stat = "count", fill = "mediumseagreen", 
           color = "mediumseagreen") + 
  labs(title = "Should the EPA be given the power to regulate CO2 emissions?", 
       x = "Support                                                                Oppose", 
       y = "Count", 
       caption = "Based on data from the Cooperative Congressional Election Study, 2018") + 
  scale_x_discrete(labels=c("1" = "Support", "2" = "Oppose")) + 
  theme(plot.title = element_text(face = "bold", 
                                  size = 17))
```

```{r}

action <- cces2018 %>%
select(CO2, MPG, Reneww, JobsVEnvir, Paris) %>%
  mutate(category = case_when(
    (cces2018$CO2) == 1 ~ "1",
    (cces2018$MPG) == 1 ~ "2",
    (cces2018$Reneww) == 1 ~ "3",
    (cces2018$JobsVEnvir) == 1 ~ "4",
    (cces2018$Paris) == 1 ~ "5"))

# plotting density and filling by cased categories
# assigning themes and correcting labels

cces2018 %>%  
  ggplot(aes(action, fill = action$category)) +
  geom_density(alpha = .4, colour = "black", size = 0.73) +
  labs(fill = "Number of Kids", title = "Hours Wife Works A Week", x = "Hours Worked", y = "Density", caption = "Craig Olson (1998)") +
  scale_fill_viridis_d() +
  theme_classic()

```

``` {r shiny, include = F}

ui <- fluidPage(
  plotOutput(outputId = "figure1")
)
server <- function(input, output) {
  output$figure1 <- renderPlot({figure1
    
  })
}
shinyApp(ui = ui, server = server)
```
